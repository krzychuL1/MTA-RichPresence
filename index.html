<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    .przyciski{
      height: 100px;
      width: 780px;
    }
    .pasek {
      position: fixed;
      top: 37%;
      height: 2px;
      width: 100%;
      background-color: black; 
}
    .logi{
      text-align: center;
      size: 20px;
    }
    
  </style>
</head>
<body>
  <h1 style="text-align: center; size: 50px;">MTA Discord Rich Presence</h1>
  <p style="text-align: center; size: 15px">Wersja 1.0.0</p>
  <div class="przyciski">
    <label for="status-select">Statusy frakcyjne:</label>
    <select style="position: fixed; left: 20%;" id="status-select">
        <option value="San Andreas Police Department">San Andreas Police Department</option>
        <option value="San Andreas Road Assistance">San Andreas Road Assistance</option>
        <option value="Transport of San Andreas">Transport of San Andreas</option>
    </select>
    <label style="position: fixed; left: 50%;" for="status-select2">Statusy biznesowe:</label>
    <select style="position: fixed; left: 70%;" id="status-select2">
        <option value="Buildings4you">Buildings4you</option>
        <option value="41.St Mechanized Infantry Division">41.St Mechanized Infantry Division</option>
    </select><br>
    <button style="position: fixed; left: 10%; top: 25%;" id="set-status-button">Ustaw Status Frakcyjny</button>
    <button style="position: fixed; left: 60%; top: 25%;" id="set-status-button2">Ustaw Status Biznesowy</button><br>
    <button style="position: fixed; left: 38%; top: 32%;" id="status-reset">Zresetuj status</button>
    <button style="position: fixed; left: 52%; top: 32%;" id="clear-log-btn">Wyczyść log</button>
    <div class="pasek"></div>
  </div>
  <div class="logi">
    <strong><pre id="log"></pre></strong>
  </div>
  <div id="status" style="position: fixed; bottom: 10px; right: 10px;"></div>
  <script>
const { ipcRenderer } = require('electron');
const MAX_LOG_LENGTH = 460; // maksymalna długość loga

// nasłuchiwanie na kliknięcie przycisku "Wyczyść log"
const clearLogBtn = document.getElementById('clear-log-btn');
clearLogBtn.addEventListener('click', () => {
  const logEl = document.getElementById('log');
  logEl.textContent = '';
});

ipcRenderer.on('log', (event, data) => {
  const logEl = document.getElementById('log');
  logEl.textContent += data + '\n';

  // usuń starsze wpisy, kiedy długość tekstu przekroczy MAX_LOG_LENGTH
  if (logEl.textContent.length > MAX_LOG_LENGTH) {
    logEl.textContent = logEl.textContent.substr(logEl.textContent.indexOf('\n') + 1);
  }
});



    const setStatusButton = document.getElementById('set-status-button');
   const statusSelect = document.getElementById('status-select');

  setStatusButton.addEventListener('click', () => {
    const status = statusSelect.value;
    ipcRenderer.send('set-status', status);
});

const setStatusButton2 = document.getElementById('set-status-button2');
   const statusSelect2 = document.getElementById('status-select2');

  setStatusButton2.addEventListener('click', () => {
    const status2 = statusSelect2.value;
    ipcRenderer.send('set-status2', status2);
});

const resetStatusButton = document.getElementById('status-reset');

// Obsługa kliknięcia przycisku
resetStatusButton.addEventListener('click', () => {
  // Wysłanie zdarzenia do procesu głównego z prośbą o zmianę statusu Discord RPC
  ipcRenderer.send('reset-rpc-status');
});

const statusEl = document.getElementById('status');
  let frame = 0;
  const frames = ['Aplikacja działa.', 'Aplikacja działa..', 'Aplikacja działa...', 'Aplikacja działa.'];
  statusEl.textContent = frames[frame];

  // Definicja funkcji zmieniającej ramkę animacji
  const nextFrame = () => {
    frame = (frame + 1) % frames.length;
    statusEl.textContent = frames[frame];
  };

  // Uruchomienie animacji z prędkością 500ms na ramkę
  const intervalId = setInterval(nextFrame, 500);
  </script>

</body>
</html>
